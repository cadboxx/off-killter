<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Off-Killter</title>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-render-order-component@1.1.0/dist/aframe-render-order-component.min.js"></script>
    <script src="https://unpkg.com/aframe-randomizer-components@3.0.2/dist/aframe-randomizer-components.min.js"></script>
    <script src="https://unpkg.com/aframe-haptics-component/dist/aframe-haptics-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
    <script src="https://rawgit.com/fernandojsg/aframe-teleport-controls/master/dist/aframe-teleport-controls.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v4.0.1/dist/aframe-physics-system.min.js"></script>
    <script src="./src/index.js"></script>
  </head>
  <body>
    <a-scene start-game toggle-debug renderer="antialias: true; highRefreshrate: true;" physics="gravity: -1.6">
      <a-assets timeout="10000">
        <a-asset-item id="leftHandModel" src="assets/leftHand.glb"></a-asset-item>
        <a-asset-item id="rightHandModel" src="assets/rightHand.glb"></a-asset-item>
        <img offset="{x: 50, y: 0}" id="face-texture" src="assets/facetext.jpg">
        <img id="help-manual-texture" src="assets/robot_manual_off-killter.jpg">
      </a-assets>

      <!-- Scene props -->
      <a-entity id="table" position="-1 0 -3" rotation="0 90 0">
        <a-box static-body position="-1 1 -3" height="0.05" width="4" depth="2.5" rotation="0 0 0" color="#a8ccd7" opacity="0.25"></a-box>
        <a-cylinder static-body position="0.5 0.5 -4" radius="0.05" height="1" color="#000000"></a-cylinder>
        <a-cylinder static-body position="0.5 0.5 -2" radius="0.05" height="1" color="#000000"></a-cylinder>
        <a-cylinder static-body position="-2.5 0.5 -4" radius="0.05" height="1" color="#000000"></a-cylinder>
        <a-cylinder static-body position="-2.5 0.5 -2" radius="0.05" height="1" color="#000000"></a-cylinder>
      </a-entity>

      <!-- Help Manual -->
      <a-box constraint="target: #folder;" id="paper" material='color: white; src: #help-manual-texture; flatShading: true;' class="grabbable" rotation='90 90 180' width='0.2159' height='0.2794' depth='0.005' position='-3 1.106 -2.125' dynamic-body="mass: 1"></a-box>
      <a-box id="folder" material='color: #fff1d6' class="grabbable" rotation='90 90 0' width='0.4826' height='0.295275' depth='0.006' position='-3 1.1 -2' dynamic-body></a-box>
      
      <!-- Define Scene Room -->
      <a-entity id="intRoom">
        <!-- floor -->
        <a-plane static-body position="0 0 0" rotation="-90 0 0" width="20" height="20" color="#474747"></a-plane>
        <!-- ceiling -->
        <a-plane position="0 4 0" rotation="90 0 0" width="20" height="20" color="#FFFFFF"></a-plane>
        <!-- lower walls -->
        <a-plane position="0 1 -10" rotation="0 0 0" width="20" height="2" color="#001d29"></a-plane>
        <a-plane position="10 1 0" rotation="0 -90 0" width="20" height="2" color="#001d29"></a-plane>
        <a-plane position="-10 1 0" rotation="0 90 0" width="20" height="2" color="#001d29"></a-plane>
        <!-- upper walls -->
        <a-plane position="0 3 -10" rotation="0 0 0" width="20" height="2" color="#007eb0"></a-plane>
        <a-plane position="10 3 0" rotation="0 -90 0" width="20" height="2" color="#007eb0"></a-plane>
        <a-plane position="-10 3 0" rotation="0 90 0" width="20" height="2" color="#007eb0"></a-plane>
        <!-- glass wall -->
        <a-box position="-7 1 10" rotation="-180 0 0" depth="0.2" width="6" height="2" color="#001d29"></a-box>
        <a-box position="7 3 10" rotation="-180 0 0" depth="0.2" width="6" height="2" color="#007eb0"></a-box>
        <a-box position="7 1 10" rotation="-180 0 0" depth="0.2" width="6" height="2" color="#001d29"></a-box>
        <a-box position="-7 3 10" rotation="-180 0 0" depth="0.2" width="6" height="2" color="#007eb0"></a-box>
        <a-box position="0 0.25 10" rotation="-180 0 0" depth="0.2" width="8" height="1" color="#001d29"></a-box>
        <a-box position="0 3.75 10" rotation="-180 0 0" depth="0.2"width="8" height="1" color="#007eb0"></a-box>
        <!-- glass -->
        <!-- <a-box position="0 2 10" rotation="-180 0 0" depth="0.05" width="8" height="2.5" color="#a8ccd7" opacity="0.25"></a-box> -->
      </a-entity>

      <!-- Define Replay Room -->
      <a-entity id="replayRoom">
        <!-- floor -->
        <a-plane position="0 0 12.5" rotation="-90 0 0" width="20" height="5" color="#474747"></a-plane>
        <!-- ceiling -->
        <a-plane position="0 4 12.5" rotation="90 0 0" width="20" height="5" color="#FFFFFF"></a-plane>
        <!-- lower walls -->
        <a-plane position="0 1 15" rotation="0 180 0" width="20" height="2" color="#001d29"></a-plane>
        <a-plane position="10 1 12.5" rotation="0 -90 0" width="5" height="2" color="#001d29"></a-plane>
        <a-plane position="-10 1 12.5" rotation="0 90 0" width="5" height="2" color="#001d29"></a-plane>
        <!-- upper walls -->
        <a-plane position="0 3 15" rotation="0 180 0" width="20" height="2" color="#007eb0"></a-plane>
        <a-plane position="10 3 12.5" rotation="0 -90 0" width="5" height="2" color="#007eb0"></a-plane>
        <a-plane position="-10 3 12.5" rotation="0 90 0" width="5" height="2" color="#007eb0"></a-plane>
        <!-- height board -->
        <a-plane position="0 1.75 14.95" rotation="-180 0 0" width="8" height="3" color="#FFFFFF"></a-box>
      </a-entity>

      <!-- Player -->
      <a-entity id="rig" position="0 0 -2">
        <a-entity static-body="shape: sphere; sphereRadius: 0.2;" id="camera" camera look-controls wasd-controls rotation="0 0 0" mirror-movement replayer>
          <a-plane id="fadePlane" position="0 0 -0.01" width="10" height="10" opacity="1.0" color="black" visible="true">
            <a-text id="startTitleText" value="Off-Killter" scale="0.01 0.01 0.01" position="-0.005 0.004 0"></a-text>
            <a-text id="startGameText" value="Enter VR to begin" color="grey" scale="0.0025 0.0025 0.0025" position="-0.00035 0.0028 0"></a-text>
            <a-text id="startSocialTextPre" value="Created by" color="grey" scale="0.002 0.002 0.002" position="-0.0015 -0.0043 0"></a-text>
            <a-text id="startSocialText" value="@elocnat" scale="0.004 0.004 0.004" position="-0.0025 -0.005 0"></a-text>
            <a-text id="startSocialTextAction" value="Follow me on Twitter for updates on #OffKillter" color="grey" scale="0.003 0.003 0.003" position="-0.007 -0.006 0"></a-text>
          </a-plane>
        </a-entity>
        <a-entity id="leftHand" teleport-controls="cameraRig: #rig; teleportOrigin: #camera;" hand-controls="hand: left; handModelStyle: lowPoly;" mirror-movement haptics static-body="shape: sphere; sphereRadius: 0.02;" sphere-collider="objects: .grabbable" grab></a-entity>
        <a-entity id="rightHand" teleport-controls="cameraRig: #rig; teleportOrigin: #camera;" hand-controls="hand: right; handModelStyle: lowPoly;" mirror-movement haptics triggered static-body="shape: sphere; sphereRadius: 0.02;" sphere-collider="objects: .grabbable" grab></a-entity>

        <!-- NOTE: For something to be intersected, needs to have class="links"! -->
        <a-entity laser-controls="hand: right; model: false;" raycaster="objects: .links; far: 20" line="color: blue; opacity: 0.25"></a-entity>
      </a-entity>

      <!-- Mirrored recording body -->
      <a-entity id="mirrorBody" position="0 0 -6" rotation="0 180 0">
        <a-entity id="leftCube">
          <a-entity id="mirrorLeftHand" rotation="0 0 90" gltf-model="#leftHandModel"></a-entity>
        </a-entity>
        <a-entity id="rightCube">
          <a-entity id="mirrorRightHand" rotation="0 0 -90" gltf-model="#rightHandModel"></a-entity>
        </a-entity>
        <a-entity id="headCube">
          <a-sphere id="mirrorHead" rotation="0 90 0" material="src: #face-texture; flatShading: true; width: 0.5;" radius="0.15"></a-sphere>
        </a-entity>
      </a-entity>

      <!-- UI -->
      <a-text id="diffMeter" value="MOVE TO FILL" align="center" position="0 2.5 -8" rotation="0 0 0" material="color: pink" scale="0.7 0.7 0.7" visible='false'>
        <a-plane id="topBar" position="0 0.25 0" width="4" height="0.05" color="black"></a-plane>
        <a-plane id="bottomBar" position="0 -0.25 0" width="4" height="0.05" color="black"></a-plane>
        <a-plane id="leftBar" position="-2 0 0" width="0.05" height="0.5" color="black"></a-plane>
        <a-plane id="rightBar" position="2 0 0" width="0.05" height="0.5" color="black"></a-plane>
      </a-text>

      <a-text id="diffButton" class="links" value="EASY" geometry="primitive:plane; width: 2; height: 0.8" align="center" position="-3 3 -8" rotation="0 25 0" material="color: green" scale="0.7 0.7 0.7" button-intersect>
        <a-text id="diffButtonText" value="(Click to change difficulty)" align="center" position="0 -0.2 0" scale="0.5 0.5 0.5" button-intersect></a-text>
      </a-text>

      <a-text id="titleText" scale="5 5 5" value="Off-Killter" color="black" position="0 3.5 -8" rotation="30 0 0" align="center" visible="true"></a-text>

      <a-text id="startText" class="links" scale="1 1 1" value="Record 3 animations to start!" color="white" position="0 2 -8" rotation="0 0 0" align="center" visible="true" button-intersect></a-text>

      <a-text id="replayButton" class="links" value="REPLAY RECORDING" geometry="primitive:plane" position="3 1 -8" rotation="0 -25 0" material="color: grey" scale="0.7 0.7 0.7" align="right" visible="false" button-intersect></a-text>

      <a-text id="recordButton" class="links" value="START RECORDING" geometry="primitive:circle" position="-3 1 -8" rotation="0 25 0" material="color: red" scale="0.7 0.7 0.7" button-intersect></a-text>
    </a-scene>
  </body>
</html>
